# –õ–∞–±–∞ 3 (—Å—Ç–æ–ø –∞ —á–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ 2)

## –ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ
–ù–∞—á–∞–≤ —á–∏—Ç–∞—Ç—å —É—Å–ª–æ–≤–∏—è –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏ —ç—Ç–æ–π –ª–∞–±—ã –ø–µ—Ä–≤—ã–π –¥–≤–∞ –ø—É–Ω–∫—Ç–∞ –ø–æ–∫–∞–∑–∞–ª–∏—Å—å —É–∂ –¥–æ –±–æ–ª–∏ –∑–Ω–∞–∫–æ–º—ã–º–∏, –Ω—É –∏ –∫–∞–∫ –æ–∫–∞–∑–∞–ª–æ—Å—å –ø–æ–Ω—è—Ç–Ω–æ –ø–æ—á–µ–º—É

![](iveseenit.gif)

–ø–æ –º–æ–µ–º—É —ç—Ç–∞ –ª–∞–±–∞ –∫–∞–∫-—Ç–æ –±—É–¥–µ—Ç —Å–≤—è–∑–∞–Ω–∞ —Å –î–æ–∫–µ—Ä–æ–º, –Ω–æ –ø–æ–∫–∞ –Ω–µ –º–æ–≥—É —ç—Ç–æ –¥–æ–∫–∞–∑–∞—Ç—å

## –†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ

–¢–∞–∫ –∫–∞–∫ –Ω–∏–∫—Ç–æ –Ω–µ —Å–∫–∞–∑–∞–ª –¥–ª—è –∫–∞–∫–∏—Ö —Ä–µ—à–µ–Ω–∏–π –º—ã –±—É–¥–µ–º –ø–∏—Å–∞—Ç—å CI/CD —Ñ–∞–π–ª—ã –ø—Ä–µ–¥—Å—Ç–∞–ª —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–π –≤—ã–±–æ—Ä

![](livechangingdecision.png)

–ü–æ—Å–ª–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—á–µ–∫ —Å –≥–∏—Ç–ª–∞–±–∞ –∏ –≥–∏—Ç—Ö–∞–±–∞ –ø—Ä–æ –∏—Ö —Å–∏—Å—Ç–µ–º—ã –æ–∫–∞–∑–∞–ª–æ—Å—å —á—Ç–æ –≤—ã–±–æ—Ä –Ω–µ –∏–º–µ–ª –∑–Ω–∞—á–µ–Ω–∏—è —Ç–∞–∫ –∫–∞–∫ —É –æ–±–æ–∏—Ö –≤ –±–∞–∑–µ –≤—Å–µ –ø–æ—á—Ç–∏ —Ç–æ–∂–µ —Å–∞–º–æ–µ

–í –∏—Ç–æ–≥–µ –±—ã–ª–æ —Ä–µ—à–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–∏—Ç—Ö–∞–±–æ–≤—Å–∫–∏–π action –ø–æ—Ç–æ–º—É —á—Ç–æ —É –º–µ–Ω—è –±—ã–ª–∞ –ª–∞–±–∞ –ø–æ –Ω–µ–º—É –≤ –ø–µ—Ä–≤–æ–º —Å–µ–º–∞–∫–µ –∏ –±—É–¥–µ—Ç —Å —á–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å. 

P.S. –•–æ—Ç—è –µ—Å–ª–∏ —á–µ—Å—Ç–Ω–æ –Ω–∞–¥–æ –±—ã–ª–æ –∫–∞–∫ –ø–∞–Ω–∫ –ø–∏—Å–∞—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ –ö–æ—Ç–ª–∏–Ω–µ –¥–ª—è TeamCity

## –£–ª–∏–∫–∞, —á—Ç–æ —Ä–∞—Å–∫—Ä—ã–ª–∞ –¥–µ–ª–æ

–í –ø–æ–∏—Å–∫–∞—Ö –∫–∞–∫–∏—Ö-—Ç–æ –ø—Ä–∞–∫—Ç–∏—Å–æ–≤ –∏ –ø—Ä–æ—á—Ç–µ–Ω–∏–∏ —Å–≤–æ–µ–π —Å—Ç–∞—Ä–æ–π –ª–∞–±—ã –ø–æ Github Actions —Å—Ä–∞–∑—É —Å—Ç–∞–ª–æ –ø–æ–Ω—è—Ç–Ω–æ –æ–¥–Ω–æ... –ú—ã –∑–∞–Ω–∏–º–∞–µ–º—Å—è –∂–µ—Å—Ç–∫–æ–π –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ –∫–æ–Ω—Ç–µ—Ä–µ–Ω–∏–∑–∞—Ü–∏–µ–π –∫–∞–∫ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –í–∞—Å—è, –∞ –∫–∞–∫ –≤ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–∏ –æ–∫–∞–∑–∞–ª–æ—Å—å Gitlab runner —ç—Ç–æ –≤–æ–æ–±—â–µ literally –¥–æ–∫–µ—Ä. –î–µ–ª–æ —Ä–∞—Å–∫—Ä—ã—Ç–æ, –≤ –ò–¢–ú–û –ø—Ä–µ–ø–æ–¥–∞–µ—Ç –í–∞—Å—è, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—á–µ—Ç –≤–∑—Ä–∞—Å—Ç–∏—Ç—å –ø–æ–∫–æ–ª–µ–Ω–∏–µ DBops'–µ—Ä–æ–≤. –ù—É –∏ —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å —ç—Ç–æ–π –∏–Ω—Ñ–æ–π? –¢–∞–∫ –∫–∞–∫ –º—ã –ø–æ—á—Ç–∏ —á—Ç–æ –∑–∞–Ω–∏–º–∞–µ–º—Å—è –¥–æ–∫–µ—Ä—Å–∫–∏–º–∏ –¥–µ–ª–∏—à–∫–∞–º–∏ –ª–æ–≥–∏—á–Ω–æ, —á—Ç–æ –∏ –∫–∞–∫–∏–µ-—Ç–æ –ø—Ä–∞–∫—Ç–∏—Å—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∏ —Å—é–¥–∞ –∂–µ. –§–∞–π–ª —è —Ä–µ—à–∏–ª –ø–æ–ø–æ—Ä—Ç–∏—Ç—å —Å–ª–µ–¥—é—â–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏:

* –ù–∞—Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å –≤–∞–∂–Ω—É—é –∏–Ω—Ñ—É
* –ü–æ—Å–ª–∞—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ —Å–æ—Ñ—Ç–∞

–≠—Ç–æ –∫–ª–∞—Å—Å–Ω–æ, –Ω–æ –Ω–∞–¥–æ –º–∏–Ω–∏–º—É–º —Ç—Ä–∏ –ø—Ä–∞–∫—Ç–∏—Å–∞, –∏ —Ç—É—Ç —Å–ø–∞—Å–∏–±–æ —Å–∞–π—Ç—É –≥–∏—Ç–ª–∞–±–∞ –∑–∞ tips'—ã –∏ —Å–∞–π—Ç—É –≥–∏—Ç—Ö–∞–±–∞ –∑–∞ –æ–ø–∏—Å–∞–Ω–∏—é —Ä–∞–±–æ—Ç—ã:

* –ù–ï –ö—ç—à–∏—Ä—É–µ–º —á–µ –Ω–∞–¥–æ 
* –ù–ï –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ –¥–∂–æ–±–∞–º (—á—Ç–æ –±—ã –≤—Å–µ –ù–ï —Ä–∞–±–æ—Ç–∞–ª–æ –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å)
* –ù–ï –ü—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –¥–∂–æ–±–∞—Ö, –µ—Å–ª–∏ –Ω–∞–¥–æ

–ª–∞–¥–Ω–æ —ç—Ç–æ –ø–µ—Ä–µ–±–æ—Ä –≤—Å–µ —Ä–∞–≤–Ω–æ —Ç–æ–ª—å–∫–æ —Ç—Ä–∏ –Ω–∞–¥–æ.

## –î–µ–ª–∞–µ–º –≥—Ä—è–∑—å

–ó–∞ –æ—Å–Ω–æ–≤—É —Ä–µ—à–∏–ª —Ñ–∞–π–ª —Å–æ —Å–≤–æ–µ–π —Å—Ç–∞—Ä–æ–π –ª–∞–±—ã, –Ω–æ —Å–Ω–∞—á–∞–ª–æ –Ω–∞–¥–æ –µ–≥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å —è–≤–Ω–æ —á–µ–º —Ç–æ –±–æ–ª—å—à–µ —á–µ–º —Ç–µ—Å—Ç—ã –∏ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –ø–æ–¥ –Ω–∞—à–∏ –Ω—É–∂–¥—ã. –í–æ—Ç –∫—Å—Ç–∞—Ç–∏ –∏ –æ–Ω

```yaml
name: Workflow

on: 
  pull_request:
    branches:
      - master
      - release
      - develop
  push:
    branches:
      - tests

env:
  STUDENT_NAME: –ö–∞—Ä–∞—è–Ω–∏–¥–∏ –ë–æ–≥–¥–∞–Ω –ï–≤–≥–µ–Ω—å–µ–≤–∏—á
  STUDENT_GROUP_NUMBER: M3113

jobs:
  Tests:
    runs-on: ubuntu-latest
    steps:

      - run: echo "$STUDENT_NAME $STUDENT_GROUP_NUMBER ${{ github.actor }}"

      - uses: actions/setup-python@v4
        with:
            python-version: '3.13'
            
      - uses: actions/checkout@v3

      - run: pip install -r requirements.txt

      - run: pytest
      - run: pylint --disable=W --disable=C --disable=R *.py
```

–°–¥–µ–ª–∞—é –ø–æ–ø–µ—Ä–µ–∫ –≤—Å–µ–º—É –∏ –Ω–∞–ø–∏—à—É —Å—Ä–∞–∑—É –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–π —Ñ–∞–π–ª
```yaml
name: Workflow

on: 
  push:
    branches:
      - master
      - release
      - develop

jobs:
  Tests:
    runs-on: ubuntu-latest
    steps:

      - uses: actions/setup-python@v4
        with:
            python-version: '3.13'
            
      - uses: actions/checkout@v3

      - name: Dependecies installation
      - run: pip install -r requirements.txt

      - name: Cache dependencies
        uses: actions/cache@v3
        with:
          path: ~/.cache/pip
          key: ${{ runner.os }}-pip-${{ hashFiles('requirements.txt') }}
          restore-keys: ${{ runner.os }}-pip-

      - name: Testing
      - run: pytest

      - name: Linting
      - run: pylint *.py

  Deploy:
    needs: Tests
    runs-on: ubuntu-latest
    environment: production
    
    steps:
      - uses: actions/checkout@v3
      
      - uses: actions/setup-python@v4
        with:
          python-version: '3.13'
          
      - name: Cache dependencies
        uses: actions/cache@v3
        with:
          path: ~/.cache/pip
          key: ${{ runner.os }}-pip-${{ hashFiles('requirements.txt') }}
          restore-keys: |
            ${{ runner.os }}-pip-

      - name: Install dependencies
        run: pip install -r requirements.txt

      - name: Deploy to Server
        env:
          DEPLOY_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
          SERVER_IP: ${{ secrets.SERVER_IP }}
          USERNAME: ${{ secrets.SERVER_USERNAME }}
        run: # –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º —á—Ç–æ —Ç—É—Ç –ø—Ä–∏–∫–æ–ª—ã –¥–ª—è ssh
```

–í–æ–æ–±—â–µ –∫–∞–∫-–±—É–¥—Ç–æ –ø—Ä–∞–∫—Ç–∏—Å —Å –∫—ç—à–æ–º —Ç—É—Ç –∏–∑ –ø–∞–ª–∞–ª—å—Ü–∞ –≤—ã—Å—Å–æ—Å–∞–Ω (–∏ —è —É–≤–µ—Ä–µ–Ω —ç—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ –ø–∏—Ç–æ–Ω—É), –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–≥–¥–∞ —è —Ä—ã–ª—Å—è –ø–æ –≥–∏—Ç—Ö–∞–±—É —è —Ç–æ–ª—å–∫–æ –Ω–∞—à–µ–ª –æ–¥–Ω—É –±–æ–ª—å—à—É—é —Ä–µ–ø—É –æ—Ç huggingface [–≥–¥–µ](https://github.com/huggingface/transformers/blob/bb65d2d953a512609a86727b6de64035717b1d45/.github/workflows/add-model-like.yml#L26) —Ö–æ—Ç—å –∫–∞–∫ —Ç–æ –æ–Ω –µ—Å—Ç—å, –∏ —Ç–æ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è venv. –ù—É –ª–∏–±–æ –Ω–∏–∫—Ç–æ –ø–∏—Å–∞—Ç—å –Ω–µ —É–º–µ–µ—Ç –ª–∏–±–æ —è –ø—Ä–æ—Å—Ç–æ –Ω–∞ –ø—Ä–æ–¥–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—ã–ª –ª–∏–±–æ –Ω–∏–∫–æ–º—É –≤ –ø–∏—Ç–æ–Ω–µ —ç—Ç–æ –Ω–µ –Ω–∞–¥–æ (—á—Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ).


–ß–µ —Ç–æ –∑–∞—Ç—è–Ω—É–ª, —Ç–µ–ø–µ—Ä—å –≤—Ä–µ–º—è

## –ù–∞–≤–∞–ª–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞üòà

```yaml
name: Workflow

on: 
  push:
    branches:
      - master
      - release
      - develop

jobs:
  Tests:
    runs-on: ubuntu-latest
    steps:

      - uses: actions/setup-python@v4
        with:
            python-version: '3.X'
            
      - uses: actions/checkout@v3

      - name: Dependecies installation
      - run: pip install -r pytest pylint #–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º —á—Ç–æ —á—Ç–æ-—Ç–æ –µ—â–µ

      - name: Testing
      - run: pytest

      - name: Linting
      - run: pylint *.py

  Deploy:
    runs-on: ubuntu-latest
    environment: production
    
    steps:
      - uses: actions/checkout@v3
      
      - uses: actions/setup-python@v4
        with:
          python-version: '3.X'
          
      - name: Install dependencies
        run: pip install -r pytest pylint #–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º —á—Ç–æ —á—Ç–æ-—Ç–æ –µ—â–µ

      - name: Deploy to Server
        env:
          DEPLOY_KEY: ${{ g1pXjyeUa4VwAGJ....feR }}
          SERVER_IP: ${{ 77.234.216.2 }}
          USERNAME: ${{ root }}
        run: # –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º —á—Ç–æ —Ç—É—Ç –ø—Ä–∏–∫–æ–ª—ã –¥–ª—è ssh
```

![](daun.png)

–¢–∞–∫, –æ—Ñ–æ—Ä–º–ª—è–µ–º –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ–ª–µ—Ç –ø–æ –ø—É–Ω–∫—Ç–∞–º –∫–∞–∫ –¥–æ–≤–µ—Å—Ç–∏ —Å–µ–Ω—å–µ—Ä–∞ –¥–æ –∏–Ω—Ñ–∞—Ä–∫—Ç–∞

* –ß—Ç–æ-—Ç–∞–∫–æ–µ –≤–µ—Ä—Å–∏–∏? –í–ø–µ—Ä–≤—ã–µ —Å–ª—ã—à—É 
```yaml
python-version: '3.X'
- run: pip install -r pytest pylint #–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º —á—Ç–æ —á—Ç–æ-—Ç–æ –µ—â–µ
```
* –ó–∞—á–µ–º —è –Ω–∞–ø–∏—Å–∞–ª –Ω–∞—à [ip](https://www.whois.com/whois/77.234.216.2)? –¢–∞–∫ –µ–≥–æ –∏ —Ç–∞–∫ –≤—Å–µ –∑–Ω–∞—é—Ç
```yaml
env:
    DEPLOY_KEY: ${{ g1pXjyeUa4VwAGJ....feR }}
    SERVER_IP: ${{ 77.234.216.2 }}
    USERNAME: ${{ root }}
```
* –ü–æ—á–µ–º—É —É –Ω–∞—Å –Ω–∞ –ø—Ä–æ–¥–µ –ø–æ–ª–æ–º–∞–Ω–Ω—ã–π –∫–æ–¥? –î–∞ –≤—Ä–æ–¥–µ –±–µ–∑ —Ç–µ—Å—Ç–æ–≤ –∫–æ–¥ –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞—Ö–æ–¥–∏—Ç—å
```yaml
Deploy:
    #needs: Tests
    runs-on: ubuntu-latest
    environment: production
    
    ...
```
* –ö—ç—à? –£ –Ω–∞—Å —Ä–∞–∑–≤–µ –±–æ–ª—å—à–æ–π –ø—Ä–æ–¥? –∞, 200000 –ø—É—à–µ–π –≤ –¥–µ–Ω—å.... —É–ø—Å


–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å [***—Ç—ã–∫***](https://github.com/inview-club/devops-cases/pull/37)
